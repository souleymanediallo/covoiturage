{% extends "layout.html" %}

{% block content %}
<!-- **************** MAIN CONTENT START **************** -->
<main>
<!-- =======================
Content START -->
<section class="pt-5">
	<div class="container pt-5">
		<div class="row g-2 g-lg-2">
			<!-- Sidebar START -->
			{% include "partials/sidebar-admin.html" %}
			<!-- Sidebar END -->
			<!-- Main content START -->
			<div class="col-lg-9 col-xl-9 ps-xl-3">

				<!-- Offcanvas menu button -->
				<div class="d-grid mb-0 d-lg-none w-100">
					<button class="btn btn-primary mb-4" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasSidebar" aria-controls="offcanvasSidebar">
						<i class="fas fa-sliders-h"></i> Menu
					</button>
				</div>

				<div class="card border bg-transparent rounded-0">
					<!-- Card header -->
					<div class="card-header bg-light rounded-0 border-bottom">
						<h4 class="card-header-title text-uppercase">Publier un trajet</h4>
					</div>

					<!-- Card body START -->
					<div class="card-body p-3">
						<form class="vstack gap-2" method="POST" enctype="multipart/form-data">
                        {% csrf_token %}
                        <!-- errors -->
                        {% for field in form %}
                        {% if field.errors %}
                        <div class="alert alert-danger">
                            {{ field.errors }}
                        </div>
                        {% endif %}
                        {% endfor %}
                        <!-- Owner Detail END -->
                        <!-- Owner Detail START -->
                        <div class="card border border-radius-0 bg-light rounded-0">
                            <!-- Card body -->
                            <div class="card-body">
                                <div class="row g-3">
                                    <!-- role -->
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label"><span class="fw-bold text-dark"> Je suis : </span><span class="text-danger">*</span></label>
                                        {% for role in form.role %}
                                        <div class="d-flex gap-4">
                                            <div class="form-check radio-bg-light" id="tripTypeSection">
                                                {{ role }}
                                            </div>
                                        </div>
                                        {% endfor %}
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label"><span class="fw-bold text-dark">Type de trajet :</span><span
                                                class="text-danger">*</span></label>
                                        {% for trip_type in form.trip_type %}
                                        <div class="d-flex gap-4">
                                            <div class="form-check radio-bg-light" id="tripType">
                                                {{ trip_type }}
                                            </div>
                                        </div>
                                        {% endfor %}
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label"><span class="fw-bold text-dark">Départ</span></label>
                                        {{ form.start_city }}
                                    </div>
                                    <!-- State -->
                                    <div class="col-md-6">
                                        <label class="form-label"><span class="fw-bold text-dark">Arrivée</span></label>
                                        {{ form.end_city }}
                                    </div>
                                    <!-- Contact number -->
                                    <div class="col-md-4">
                                        <label class="form-label"><span class="fw-bold text-dark">Date Départ</span></label>
                                        {{ form.start_date }}
                                    </div>
                                    <!-- Email -->
                                    <div class="col-md-4">
                                        <label class="form-label"><span class="fw-bold text-dark">Heure Départ</span></label>
                                        {{ form.start_time }}
                                    </div>
                                    <!-- Contact number -->
                                    <div class="col-md-4 item">
                                        <label class="form-label"><span class="fw-bold text-dark">Nombre de Place Aller</span></label>
                                        <h5 class="guest-selector-count mb-0 adults">{{ form.seat_go }}</h5>
                                    </div>
                                    <!-- Email -->
                                </div>
                                <!-- round trip -->
                                <div class="row g-3 mt-2">
                                        <!-- round_trip -->
                                    <div class="col-md-4">
                                        <label class="form-label">Date Retour</label>
                                        {{ form.return_date }}
                                    </div>
                                    <div class="col-md-4">
                                        <label class="form-label">Heure Retour</label>
                                        {{ form.return_time }}
                                    </div>
                                    <div class="col-md-4 item">
                                        <label class="form-label">Nombre de Place Retour</label>
                                        <h5 class="guest-selector-count mb-0 adults">{{ form.seat_back }}</h5>
                                    </div>
                                    <!-- round_trip -->
                                   </div>
                                <!-- end round trip -->
                            </div>
                        </div>
                        <!-- Owner Detail END -->
                        <!-- Owner Detail START -->
                        <div class="card border rounded-0 border-radius-0 bg-light">
                            <!-- Card body -->
                            <div class="card-body">
                                <div class="row justify-content-between text-sm-center">
                                    <!-- Item start -->
                                    <div class="col-md-4 item div" id="id_price">
                                        <label class="form-label"><span class="fw-bold text-dark">Prix par place en FCA</span></label>
                                        <h5 class="guest-selector-count mb-0 adults">{{ form.price }}</h5>
                                    </div>
                                    <!-- end Item -->
                                    <div class="col-md-4 item div" id="id_price1">
                                        <label class="form-label">Bagage de 12 kilos</label>
                                        <h5 class="guest-selector-count mb-0 adults">{{ form.cabin_baggage }}</h5>
                                    </div>
                                    <!-- end Item -->
                                    <!-- Item start -->
                                    <div class="col-md-4 item div" id="id_price2">
                                        <label class="form-label">Bagage de 23 kilos</label>
                                        <h5 class="guest-selector-count mb-0 adults">{{ form.checked_baggage }}</h5>
                                    </div>
                                </div>
                            </div>
                            <!-- Address -->
                        </div>
                        <!-- Owner Detail END -->

                        <!-- Owner Detail START -->
                        <div class="card border rounded-0 bg-light mt-3">
                            <!-- Card body -->
                            <div class="card-body">
                                <div class="row g-3">
                                    <!-- Commentaire -->
                                    <div class="col-12">
                                        <label class="form-label">Commentaire</label>
                                        {{ form.description }}
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Owner Detail END -->

                        <!-- Button -->
                        <div class="text-end">
                            <button class="btn btn-primary mb-0 me-2" type="submit">Publier mon trajet</button>
                        </div>
                    </form>
					</div>
					<!-- Card body END -->
				</div>

			</div>
			<!-- Main content END -->
		</div>
	</div>
</section>
<!-- =======================
Content END -->
</main>
<!-- **************** MAIN CONTENT END **************** -->

{% endblock %}

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const tripTypeInputs = document.querySelectorAll('input[name="trip_type"]');
        const roundTripFields = document.getElementById('roundTripFields');

        tripTypeInputs.forEach(input => {
            input.addEventListener('change', function() {
                if (this.value === 'round_trip') {
                    roundTripFields.style.display = 'flex';
                } else {
                    roundTripFields.style.display = 'none';
                }
            });
        });

        // Masquer au chargement initial si "aller simple" est sélectionné par défaut
        const selectedTripType = document.querySelector('input[name="trip_type"]:checked');
        if (selectedTripType && selectedTripType.value !== 'round_trip') {
            roundTripFields.style.display = 'none';
        }
    });
</script>


